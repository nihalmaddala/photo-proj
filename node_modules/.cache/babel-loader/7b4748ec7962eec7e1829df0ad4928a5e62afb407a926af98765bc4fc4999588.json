{"ast":null,"code":"// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { hasOwn } from \"./values.mjs\";\nconst levelNumbers = {\n  off: 0,\n  error: 200,\n  warn: 300,\n  info: 400,\n  debug: 500\n};\nexport const parseLogLevel = (maybeLevel, sourceName, client) => {\n  if (!maybeLevel) {\n    return undefined;\n  }\n  if (hasOwn(levelNumbers, maybeLevel)) {\n    return maybeLevel;\n  }\n  loggerFor(client).warn(`${sourceName} was set to ${JSON.stringify(maybeLevel)}, expected one of ${JSON.stringify(Object.keys(levelNumbers))}`);\n  return undefined;\n};\nfunction noop() {}\nfunction makeLogFn(fnLevel, logger, logLevel) {\n  if (!logger || levelNumbers[fnLevel] > levelNumbers[logLevel]) {\n    return noop;\n  } else {\n    // Don't wrap logger functions, we want the stacktrace intact!\n    return logger[fnLevel].bind(logger);\n  }\n}\nconst noopLogger = {\n  error: noop,\n  warn: noop,\n  info: noop,\n  debug: noop\n};\nlet cachedLoggers = /* @__PURE__ */new WeakMap();\nexport function loggerFor(client) {\n  const logger = client.logger;\n  const logLevel = client.logLevel ?? 'off';\n  if (!logger) {\n    return noopLogger;\n  }\n  const cachedLogger = cachedLoggers.get(logger);\n  if (cachedLogger && cachedLogger[0] === logLevel) {\n    return cachedLogger[1];\n  }\n  const levelLogger = {\n    error: makeLogFn('error', logger, logLevel),\n    warn: makeLogFn('warn', logger, logLevel),\n    info: makeLogFn('info', logger, logLevel),\n    debug: makeLogFn('debug', logger, logLevel)\n  };\n  cachedLoggers.set(logger, [logLevel, levelLogger]);\n  return levelLogger;\n}\nexport const formatRequestDetails = details => {\n  if (details.options) {\n    details.options = {\n      ...details.options\n    };\n    delete details.options['headers']; // redundant + leaks internals\n  }\n  if (details.headers) {\n    details.headers = Object.fromEntries((details.headers instanceof Headers ? [...details.headers] : Object.entries(details.headers)).map(([name, value]) => [name, name.toLowerCase() === 'authorization' || name.toLowerCase() === 'cookie' || name.toLowerCase() === 'set-cookie' ? '***' : value]));\n  }\n  if ('retryOfRequestLogID' in details) {\n    if (details.retryOfRequestLogID) {\n      details.retryOf = details.retryOfRequestLogID;\n    }\n    delete details.retryOfRequestLogID;\n  }\n  return details;\n};","map":{"version":3,"names":["hasOwn","levelNumbers","off","error","warn","info","debug","parseLogLevel","maybeLevel","sourceName","client","undefined","loggerFor","JSON","stringify","Object","keys","noop","makeLogFn","fnLevel","logger","logLevel","bind","noopLogger","cachedLoggers","WeakMap","cachedLogger","get","levelLogger","set","formatRequestDetails","details","options","headers","fromEntries","Headers","entries","map","name","value","toLowerCase","retryOfRequestLogID","retryOf"],"sources":["/Users/nihalmaddala/photo-proj/node_modules/openai/src/internal/utils/log.ts"],"sourcesContent":["// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\n\nimport { hasOwn } from './values';\nimport { type OpenAI } from '../../client';\nimport { RequestOptions } from '../request-options';\n\ntype LogFn = (message: string, ...rest: unknown[]) => void;\nexport type Logger = {\n  error: LogFn;\n  warn: LogFn;\n  info: LogFn;\n  debug: LogFn;\n};\nexport type LogLevel = 'off' | 'error' | 'warn' | 'info' | 'debug';\n\nconst levelNumbers = {\n  off: 0,\n  error: 200,\n  warn: 300,\n  info: 400,\n  debug: 500,\n};\n\nexport const parseLogLevel = (\n  maybeLevel: string | undefined,\n  sourceName: string,\n  client: OpenAI,\n): LogLevel | undefined => {\n  if (!maybeLevel) {\n    return undefined;\n  }\n  if (hasOwn(levelNumbers, maybeLevel)) {\n    return maybeLevel;\n  }\n  loggerFor(client).warn(\n    `${sourceName} was set to ${JSON.stringify(maybeLevel)}, expected one of ${JSON.stringify(\n      Object.keys(levelNumbers),\n    )}`,\n  );\n  return undefined;\n};\n\nfunction noop() {}\n\nfunction makeLogFn(fnLevel: keyof Logger, logger: Logger | undefined, logLevel: LogLevel) {\n  if (!logger || levelNumbers[fnLevel] > levelNumbers[logLevel]) {\n    return noop;\n  } else {\n    // Don't wrap logger functions, we want the stacktrace intact!\n    return logger[fnLevel].bind(logger);\n  }\n}\n\nconst noopLogger = {\n  error: noop,\n  warn: noop,\n  info: noop,\n  debug: noop,\n};\n\nlet cachedLoggers = /* @__PURE__ */ new WeakMap<Logger, [LogLevel, Logger]>();\n\nexport function loggerFor(client: OpenAI): Logger {\n  const logger = client.logger;\n  const logLevel = client.logLevel ?? 'off';\n  if (!logger) {\n    return noopLogger;\n  }\n\n  const cachedLogger = cachedLoggers.get(logger);\n  if (cachedLogger && cachedLogger[0] === logLevel) {\n    return cachedLogger[1];\n  }\n\n  const levelLogger = {\n    error: makeLogFn('error', logger, logLevel),\n    warn: makeLogFn('warn', logger, logLevel),\n    info: makeLogFn('info', logger, logLevel),\n    debug: makeLogFn('debug', logger, logLevel),\n  };\n\n  cachedLoggers.set(logger, [logLevel, levelLogger]);\n\n  return levelLogger;\n}\n\nexport const formatRequestDetails = (details: {\n  options?: RequestOptions | undefined;\n  headers?: Headers | Record<string, string> | undefined;\n  retryOfRequestLogID?: string | undefined;\n  retryOf?: string | undefined;\n  url?: string | undefined;\n  status?: number | undefined;\n  method?: string | undefined;\n  durationMs?: number | undefined;\n  message?: unknown;\n  body?: unknown;\n}) => {\n  if (details.options) {\n    details.options = { ...details.options };\n    delete details.options['headers']; // redundant + leaks internals\n  }\n  if (details.headers) {\n    details.headers = Object.fromEntries(\n      (details.headers instanceof Headers ? [...details.headers] : Object.entries(details.headers)).map(\n        ([name, value]) => [\n          name,\n          (\n            name.toLowerCase() === 'authorization' ||\n            name.toLowerCase() === 'cookie' ||\n            name.toLowerCase() === 'set-cookie'\n          ) ?\n            '***'\n          : value,\n        ],\n      ),\n    );\n  }\n  if ('retryOfRequestLogID' in details) {\n    if (details.retryOfRequestLogID) {\n      details.retryOf = details.retryOfRequestLogID;\n    }\n    delete details.retryOfRequestLogID;\n  }\n  return details;\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}